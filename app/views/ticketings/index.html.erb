<head>
	<%= stylesheet_link_tag "ticketings" %>
</head>
<!-- JavaScript Bundle with Popper -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3" crossorigin="anonymous"></script>
<!-- CSS only -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">
<div class="container">
	<div class="row">
		<div class="row col-9">
			<div class="col-9">
				<h2>빠른 예매</h2>
			</div>
			<div class="col-9 mt-2">
				<h5>관람권 및 할인적용</h5>
			</div>
			<div class="dropdown col-12 mt-3">
				<a class="btn btn-secondary gap-2 col-12 btn-light btn-outline-dark" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
					메가박스 포인트
				</a>
				<ul id="aa22" class="dropdown-menu position-relative">
					<li><button class = "btn btn-outline-dark"><a class="dropdown-item" href="#">메가박스 멤버쉽 </a></button></li>
					<li><button class = "btn btn-outline-dark"><a class="dropdown-item" href="#">메가박스 할인쿠폰</a></button></li>
					<li><button class = "btn btn-outline-dark"><a class="dropdown-item" href="#">메가박스 VIP영화쿠폰</a></button></li>
				</ul>
			</div>
			<div class="dropdown col-12 mt-3">
				<a class="btn gap-2 col-12 btn-light btn-outline-dark" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="true">
					관람권/모바일상품권
				</a>
				<ul id="aa22" class="dropdown-menu position-relative">
					<li><button class = "btn btn-outline-dark"><a class="dropdown-item" href="#">메가박스 관람권</a></button></li>
					<li><button class = "btn btn-outline-dark"><a class="dropdown-item" href="#">메가박스/페이즈 금액권</a></button></li>
					<li><button class = "btn btn-outline-dark"><a class="dropdown-item" href="#">스토어 교환권</a></button></li>
					<li><button class = "btn btn-outline-dark"><a class="dropdown-item" href="#">모바일 관람권</a></button></li>
					<li><button class = "btn btn-outline-dark"><a class="dropdown-item" href="#">도서문화상품권</a></button></li>
					<li><button class = "btn btn-outline-dark"><a class="dropdown-item" href="#">컬쳐랜드 모바일 문화상품권</a></button></li>
					<li><button class = "btn btn-outline-dark"><a class="dropdown-item" href="#">플래티넘/스타카드/프렌즈</a></button></li>
					<li><button class = "btn btn-outline-dark"><a class="dropdown-item" href="#">메가박스 아너스카드</a></button></li>
				</ul>
			</div>
			<div class="dropdown col-12 mt-3">
				<a class="btn btn-secondary gap-2 col-12 btn-light btn-outline-dark" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
					제휴포인트
				</a>
				<ul id="aa22" class="dropdown-menu position-relative">
					<li><button class = "btn btn-outline-dark"><a class="dropdown-item" href="#">U+ 멤버쉽</a></button></li>
					<li><button class = "btn btn-outline-dark"><a class="dropdown-item" href="#">OK캐쉬백</a></button></li>
					<li><button class = "btn btn-outline-dark"><a class="dropdown-item" href="#">L.POINT</a></button></li>
					<li><button class = "btn btn-outline-dark"><a class="dropdown-item" href="#">GS&POINT</a></button></li>
					<li><button class = "btn btn-outline-dark"><a class="dropdown-item" href="#">현대오일뱅크</a></button></li>
					<li><button class = "btn btn-outline-dark"><a class="dropdown-item" href="#">해피포인트</a></button></li>
					<li><button class = "btn btn-outline-dark"><a class="dropdown-item" href="#">블루멤버스 포인트</a></button></li>
					<li><button class = "btn btn-outline-dark"><a class="dropdown-item" href="#">중앙멤버십</a></button></li>
					<li><button class = "btn btn-outline-dark"><a class="dropdown-item" href="#">현대 M 포인트 카드</a></button></li>
					<li><button class = "btn btn-outline-dark"><a class="dropdown-item" href="#">해피머니상품권 해피캐시</a></button></li>
					<li><button class = "btn btn-outline-dark"><a class="dropdown-item" href="#">도서상품권 북앤라이프캐시</a></button></li>
					<li><button class = "btn btn-outline-dark"><a class="dropdown-item" href="#">문화상품권 컬쳐캐쉬</a></button></li>
					<li><button class = "btn btn-outline-dark"><a class="dropdown-item" href="#">문화누리카드</a></button></li>
				</ul>
			</div>
		</div>
		<div class="row col-3 mt-5">
			<div class="col-12 row-9 mt-2">
				<div class="card">
					<% @ticketings.each do |ticketing| %>
					<div class="card-header">
						<h5>
							<%= ticketing.screen.movie.movie_title %>
						</h5>
						<strong>
							<%= ticketing.screen.theater_room.theater_id %>/<%= ticketing.screen.theater_room.tr_name %>
						</strong>
						<strong>
							<%= ticketing.screen.sc_start %> ~ <%= ticketing.screen.sc_end %>
						</strong>
					</div>

					<div class="card-body">
						<h5 class="card-title"><%= ticketing.screen.movie.movie_title %></h5>
						<p class="card-text">최종결제금액: <%= number_to_currency(ticketing.tk_price) %></p>
						<% end %>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

<div class = "container">
	<div class = "row">
		<div class = "col-10">
			<h2>결제수단선택</h2>
		</div>	
		<div class="form-check form-check-inline col-2 mt-2">
		  <input class="form-check-input" type="radio" name="inlineRadioOptions" id="inlineRadio1" value="option1">
		  <label class="form-check-label" for="inlineRadio1">신용/체크카드</label>
		</div>
		<div class="form-check form-check-inline col-2 mt-2">
		  <input class="form-check-input" type="radio" name="inlineRadioOptions" id="inlineRadio2" value="option2">
		  <label class="form-check-label" for="inlineRadio2">휴대폰 결제</label>
		</div>
		<div class="form-check form-check-inline col-2 mt-2">
		  <input class="form-check-input" type="radio" name="inlineRadioOptions" id="inlineRadio3" value="option3">
		  <label class="form-check-label" for="inlineRadio3">간편결제</label>
		</div>
		<div class="form-check form-check-inline col-2 mt-2">
		  <input class="form-check-input" type="radio" name="inlineRadioOptions" id="inlineRadio4" value="option4">
		  <label class="form-check-label" for="inlineRadio4">카카오페이</label>
		</div>
		
		<button id="payment_btn" style = "margin-top : 15px;">결제하기</button>

		<script>
			$(function(){
				var IMP = window.IMP; // 생략 가능
				IMP.init('imp27562638'); // 예: imp00000000
				function requestPay() {
			  // IMP.request_pay(param, callback) 결제창 호출
				  IMP.request_pay({ // param
					  pg: "kakaopay",
					  pay_method: "card",
					  merchant_uid: 'merchant_' + new Date().getTime(),
					  name: "Megabox 결제테스트",
						amount : 12000,
						buyer_email : $("#eamil").val(),
						buyer_name : $("#name").val(),
						buyer_tel : $("#phone").val(),
				  }, function (rsp) { // callback
					  if (rsp.success) {
						 var msg = '결제가 완료되었습니다.';
						  msg += '상점 거래ID: '+ rsp.imp_uid;
					  } else {
						  var msg = '결제에 실패하였습니다.';
						  msg += rsp.error_msg;
					  }
					  alert(msg);
				  });
				}
			$("#payment_btn").on("click", function(e){
				e.preventDefault();
				requestPay();
			})	
			})
		</script>
	</div>
</div>
