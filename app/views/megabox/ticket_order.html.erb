<div class="container">
	<div class="row">
		<div class="col-9">좌석
			<% @seats.each do |seat| %>
				<%= seat.seat_name %>
			<% end %>
		</div>
		<div class="col-3">영화 정보
			<button id="payment_btn">결제하기</button>
		</div>
	</div>
</div>

<script>
	var seats = []; 
	for (var i=1; i<11; i++) { 
	   seats[i] = false; 
	} 
	function reserve(bValue) { 
	   var msg = " "; 
	   var seatNo = document.getElementById("sNo").value; 
	   seatNo = Number(seatNo) - 1; 
	   if(bValue) { 
		  if(seats[seatNo]) { 
			 msg = seatNo+1 + "번 좌석은 이미 예약되었습니다."; 
			 } else { 
			 seats[seatNo] = true; 
			 showSeatColor(bValue, seatNo+1); 
		  } 
		  } else { 
		  if(!seats[seatNo]) { 
			 msg = seatNo+1 + "좌석은 예약이 없습니다.."; 
			 } else { 
			 seats[seatNo] = false; 
			 showSeatColor(bValue, seatNo+1); 
		  } 
	   } 
	   var dMsg = document.getElementById("div_msg"); 
	   dMsg.innerHTML = msg; 
	} 
	function showSeatColor(bValue, seatNo) { 
	   var seatld = document.getElementById("s"+seatNo); 
	   if(bValue) 
	   seatld.style.backgroundColor = 'cyan'; 
	   else 
	   seatld.style.backgroundColor = 'white'; 
	} 
</script>

<script>
	$(function(){
		var IMP = window.IMP; // 생략 가능
    	IMP.init('imp27562638'); // 예: imp00000000		
		
		function requestPay() {
      // IMP.request_pay(param, callback) 결제창 호출
		  IMP.request_pay({ // param
			  pg: "kakaopay",
			  pay_method: "card",
			  merchant_uid: "ORD20180131-0000011",
			  name: "노르웨이 회전 의자",
			  amount: 64900,
			  buyer_email: "gildong@gmail.com",
			  buyer_name: "홍길동",
			  buyer_tel: "010-4242-4242",
			  buyer_addr: "서울특별시 강남구 신사동",
			  buyer_postcode: "01181"
		  }, function (rsp) { // callback
			  if (rsp.success) {
				 var msg = '결제가 완료되었습니다.';
				  msg += '상점 거래ID: '+ rsp.imp_uid;
			  } else {
				  var msg = '결제에 실패하였습니다.';
			  }
			  alert(msg);
		  });
		}
	$("#payment_btn").on("click", function(e){
		e.preventDefault();
		requestPay();
	})	
		
	})
	
	
</script>
